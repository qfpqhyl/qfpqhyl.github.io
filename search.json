[{"title":"如何在服务器中快捷部署V2Ray代理","url":"/2025/11/11/how-to-install-v2ray-on-server/","content":"\n> 将科研工作的第一关由配置各种镜像源改编为配置网络环境。\n\n# V2Ray 代理安装模块\n\nV2Ray 完整版安装脚本，无需 root 权限即可安装，支持 VMess、VLESS、Shadowsocks 协议，具备完整的服务器管理和订阅切换功能。\n\n## 功能特性\n\n- ✅ **多协议支持**: VMess、VLESS、Shadowsocks\n- ✅ **智能订阅解析**: 自动解析多种格式订阅链接\n- ✅ **服务器管理**: 节点切换、状态监控、自动重连\n- ✅ **代理模式**: 本机代理 / 局域网共享\n- ✅ **安全认证**: 支持用户名密码认证\n- ✅ **DNS 优化**: 国内 DNS 优化配置\n- ✅ **智能路由**: 分流规则，国内外流量智能处理\n\n## 快速使用\n\n### 步骤 1：准备工作\n\n如果服务器网络受限无法直接访问外网，需要先建立临时代理隧道：\n\n```bash\n# 在本地机器上执行（确保本地有代理服务运行在10809端口，根据自己情况，设置别的端口也可以）\nssh -R 10809:127.0.0.1:10809 username@your-server-ip -p ssh-port\n```\n\n然后在服务器上设置临时代理：\n\n```bash\nexport http_proxy=http://127.0.0.1:10809\nexport https_proxy=http://127.0.0.1:10809\n```\n\n### 步骤 2：下载并运行安装脚本\n\n```bash\n# 下载安装脚本\nwget https://raw.githubusercontent.com/qfpqhyl/server-scripts/main/proxy/linux/install_v2ray.sh\n\n# 给脚本执行权限\nchmod +x install_v2ray.sh\n\n# 运行安装脚本\n./install_v2ray.sh\n```\n\n### 步骤 3：输入订阅链接\n\n安装过程中会提示输入 V2Ray 订阅链接：\n\n```\n请输入订阅链接: https://your-subscription-url.com/link/xxxxx\n```\n\n### 步骤 4：选择服务器\n\n脚本会自动解析订阅并显示所有可用服务器，选择一个进行连接：\n\n```\n=== 所有服务器 (25) ===\n[1] 🔵 香港-VMess-01\n    VMESS - hk1.example.com:443\n[2] 🟢 美国-VLESS-02\n    VLESS - us1.example.com:443\n[3] 🟡 日本-SS-03\n    SHADOWSOCKS - jp1.example.com:8080\n\n请选择要使用的服务器 (1-25) [默认: 1]: 1\n```\n\n### 步骤 5：完成安装\n\n安装完成后，运行以下命令加载别名配置：\n\n```bash\nsource ~/.bashrc\n```\n\n现在可以取消临时代理设置：\n\n```bash\nunset http_proxy https_proxy\n```\n\n## 基本管理命令\n\n安装完成后，可使用以下别名命令（需要 `source ~/.bashrc` 生效）：\n\n```bash\n# 服务管理\nv2start          # 启动V2Ray\nv2stop           # 停止V2Ray\nv2restart        # 重启V2Ray\nv2status         # 查看状态\nv2log            # 查看日志\n\n# 服务器管理\nv2switch         # 切换服务器\nv2list           # 列出所有服务器\nv2vmess          # 列出VMess服务器\nv2vless          # 列出VLESS服务器\nv2ss             # 列出Shadowsocks服务器\n\n# 订阅管理\nv2update         # 更新订阅\nv2scan           # 重新解析订阅\n\n# 代理连接\nv2connect        # 快速连接代理\nproxy_on         # 开启代理\nproxy_off        # 关闭代理\nproxy_status     # 查看代理状态\n```\n\n## 配置说明\n\n### 代理端口配置\n\n| 代理类型 | 端口 | 用途          |\n| -------- | ---- | ------------- |\n| SOCKS5   | 1080 | 通用代理协议  |\n| HTTP     | 8080 | HTTP 代理协议 |\n\n### DNS 配置\n\n- **国内 DNS**: 223.5.5.5 (阿里云)\n- **备用 DNS**: 114.114.114.114\n- **国外 DNS**: 8.8.8.8 (Google)\n- **分流规则**: 国内外流量智能分流\n\n### 路由规则\n\n- **直连**: 私有 IP、国内 IP、国内域名\n- **代理**: 国外 IP 和域名\n- **策略**: IPOnDemand 智能选择\n\n## 文件结构\n\n安装完成后，V2Ray 的工作目录位于 `~/v2ray/`：\n\n```\n~/v2ray/\n├── v2ray                    # V2Ray 主程序\n├── config.json              # 当前配置文件\n├── servers_all.json         # 所有服务器配置\n├── subscription.txt         # 原始订阅内容\n├── subscription_url.txt     # 订阅链接\n├── v2ray.log                # 运行日志\n├── v2ray.pid                # 进程PID文件\n├── full_parser.py           # 订阅解析脚本\n├── server_manager.py        # 服务器管理脚本\n├── start.sh                 # 启动脚本\n├── stop.sh                  # 停止脚本\n├── restart.sh               # 重启脚本\n├── status.sh                # 状态脚本\n├── switch.sh                # 切换脚本\n├── update.sh                # 更新脚本\n└── connect.sh               # 连接脚本\n```\n\n## 常见问题\n\n### Q: 如何更换订阅链接？\n\nA: 运行 `v2update` 命令，选择输入新的订阅链接即可。\n\n### Q: 如何切换到其他服务器？\n\nA: 运行 `v2switch` 命令，选择要切换的服务器编号。\n\n### Q: 局域网其他设备如何连接？\n\nA: 确保选择局域网共享模式，使用以下地址：\n\n- SOCKS5: `socks5://用户名:密码@服务器IP:1080`\n- HTTP: `http://用户名:密码@服务器IP:8080`\n\n### Q: 如何查看当前使用的服务器？\n\nA: 运行 `v2status` 命令，会显示当前服务器信息。\n\n### Q: 连接失败怎么办？\n\nA:\n\n1. 检查 `v2status` 确认服务运行状态\n2. 查看 `v2log` 检查错误日志\n3. 尝试 `v2switch` 切换其他服务器\n4. 运行 `v2update` 更新订阅\n\n## 更新日志\n\n### v3.0\n\n- 新增 VLESS 协议支持\n- 优化订阅解析算法\n- 改进服务器管理界面\n- 增强错误处理机制\n- 添加连接测试功能\n\n### v2.0\n\n- 重构配置生成逻辑\n- 支持局域网共享模式\n- 添加用户认证功能\n- 优化 DNS 配置\n\n### v1.0\n\n- 基础 VMess 支持\n- 简单订阅解析\n- 基本服务器切换\n\n## 技术支持\n\n如遇到问题，请：\n\n1. 查看本文档的常见问题部分\n2. 检查日志文件 `~/v2ray/v2ray.log`\n3. 提交 Issue 到项目仓库\n\n## 相关资源\n\n- **完整脚本仓库**: [https://github.com/qfpqhyl/server-scripts](https://github.com/qfpqhyl/server-scripts)\n- **V2Ray 官方文档**: [https://www.v2fly.org/](https://www.v2fly.org/)\n\n---\n\n**注意**: 本脚本仅用于学习和研究目的，请遵守当地法律法规。\n","tags":["V2Ray","代理","服务器","网络工具","自动化脚本"],"categories":["tech"]},{"title":"读研后悔吗？","url":"/2025/01/08/autumn-reflections/","content":"\nToWrite\n","tags":["生活","感悟","秋天","诗意"],"categories":["life"]}]